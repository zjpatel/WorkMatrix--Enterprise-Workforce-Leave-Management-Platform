<div class="holidays-container">
  <!-- Header -->
  <header class="page-header">
    <div class="header-content">
      <h1 class="page-title">
        <svg class="icon icon-md" viewBox="0 0 24 24">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        Company Holidays
      </h1>
      <p class="page-subtitle">View upcoming company holidays and important dates</p>
    </div>
  </header>

  <!-- Error Message -->
  <div *ngIf="error || errorMessages.length" class="error-banner">
    <span *ngIf="error && !errorMessages.length">{{ error }}</span>
    <ul *ngIf="errorMessages.length" class="error-list">
      <li *ngFor="let msg of errorMessages">{{ msg }}</li>
    </ul>
  </div>

  <!-- Main Content -->
  <div class="holidays-content">
    <!-- View Mode Toggle & Filters -->
    <div class="toolbar">
      <div class="view-toggle">
        <button 
          [class.active]="viewMode === 'calendar'"
          (click)="viewMode = 'calendar'; cdr.detectChanges()"
          class="toggle-btn">
          <svg class="icon icon-sm" viewBox="0 0 24 24">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          Calendar View
        </button>
        <button 
          [class.active]="viewMode === 'cards'"
          (click)="viewMode = 'cards'; cdr.detectChanges()"
          class="toggle-btn">
          <svg class="icon icon-sm" viewBox="0 0 24 24">
            <rect x="3" y="6" width="18" height="12" rx="2" ry="2"></rect>
            <line x1="7" y1="10" x2="17" y2="10"></line>
            <line x1="7" y1="14" x2="13" y2="14"></line>
          </svg>
          Card View
        </button>
      </div>

      <div class="filters-bar">
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-container">
      <div class="spinner"></div>
      <p class="loading-text">Loading holidays...</p>
    </div>

    <!-- CALENDAR VIEW -->
    <div *ngIf="!loading && viewMode === 'calendar'" class="calendar-view">
      <!-- Color Legend -->
      <div class="color-legend">
        <div class="legend-title">Holiday Types:</div>
        <div class="legend-items">
          <div class="legend-item">
            <div class="legend-color" style="background-color: #ef4444;"></div>
            <span>ðŸ‡®ðŸ‡³ National Holiday</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #f59e0b;"></div>
            <span>Festival</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #3b82f6;"></div>
            <span>Company Holiday</span>
          </div>
        </div>
      </div>

      <!-- Month Navigation -->
      <div class="month-header">
        <button (click)="onMonthChange('prev')" class="nav-btn">
          <svg class="icon icon-sm" viewBox="0 0 24 24">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        <h2 class="month-title">{{ months[selectedMonth] }} {{ selectedYear }}</h2>
        <button (click)="onMonthChange('next')" class="nav-btn">
          <svg class="icon icon-sm" viewBox="0 0 24 24">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </button>
      </div>

      <!-- Calendar Grid -->
      <div class="calendar-grid">
        <!-- Week Days Header -->
        <div class="weekday-header">
          <div *ngFor="let day of weekDays" class="weekday">{{ day }}</div>
        </div>

        <!-- Calendar Days -->
        <div *ngFor="let calDay of calendarDays; trackBy: trackByDay" 
             class="calendar-day" 
             [class.other-month]="!calDay.isCurrentMonth"
             [class.today]="calDay.isToday"
             [class.has-holidays]="calDay.holidays.length > 0">
          
          <div class="day-number">{{ calDay.day }}</div>
          
          <!-- Holiday Labels with Colors -->
          <div *ngIf="calDay.holidays.length > 0" class="day-holidays">
            <div *ngFor="let holiday of calDay.holidays" 
                 class="holiday-label"
                 [style.backgroundColor]="getTypeColor(holiday.holidayType)"
                 [title]="holiday.holidayName"
                 (mouseenter)="hoveredHoliday = holiday"
                 (mouseleave)="hoveredHoliday = null">
              <span class="holiday-text">{{ holiday.holidayName | slice:0:8 }}</span>
              <div *ngIf="hoveredHoliday === holiday" class="holiday-tooltip">
                <strong>{{ holiday.holidayName }}</strong>
                <small>{{ getTypeBadge(holiday.holidayType) }}</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- CARD VIEW -->
    <div *ngIf="!loading && viewMode === 'cards'" class="card-view">
      <div class="card-filter">
        <label class="filter-label">Month Filter</label>
        <select [(ngModel)]="selectedMonth" (change)="onMonthChange('select')" class="filter-select">
          <option [ngValue]="-1">All Holidays</option>
          <option *ngFor="let month of months; let i = index" [ngValue]="i">{{ month }}</option>
        </select>
      </div>

      <!-- Holiday Cards Grid -->
      <div *ngIf="holidays.length > 0" class="holidays-grid">
        <div 
          *ngFor="let holiday of holidays; trackBy: trackByHolidayId" 
          class="holiday-card"
          [style.border-left-color]="getTypeColor(holiday.holidayType)">
          
          <div class="card-header">
            <div class="card-title-section">
              <h3 class="holiday-name">{{ holiday.holidayName }}</h3>
              <span class="type-badge" [style.backgroundColor]="getTypeColor(holiday.holidayType)">
                {{ getTypeBadge(holiday.holidayType) }}
              </span>
            </div>
          </div>

          <div class="card-body">
            <div class="holiday-detail">
              <span class="detail-label">Date</span>
              <span class="detail-value">{{ formatDate(holiday.holidayDate) }} ({{ getDayOfWeek(holiday.holidayDate) }})</span>
            </div>
            
            <div class="holiday-detail">
              <span class="detail-label">Status</span>
              <span class="status-badge" [ngClass]="{ 'optional': holiday.optional, 'mandatory': !holiday.optional }">
                {{ holiday.optional ? 'Optional' : 'Mandatory' }}
              </span>
            </div>

            <div *ngIf="holiday.description" class="holiday-detail">
              <span class="detail-label">Description</span>
              <p class="detail-description">{{ holiday.description }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="holidays.length === 0" class="empty-state">
        <div class="empty-icon">
          <svg class="icon icon-lg" viewBox="0 0 24 24">
            <path d="M22 12H2"></path>
            <path d="M5 12l3 3-3 3"></path>
            <rect x="3" y="4" width="18" height="16" rx="2" ry="2"></rect>
          </svg>
        </div>
        <p class="empty-text">{{ selectedMonth === -1 ? 'No holidays for ' + selectedYear : 'No holidays for ' + months[selectedMonth] }}</p>
      </div>
    </div>
  </div>
</div>
