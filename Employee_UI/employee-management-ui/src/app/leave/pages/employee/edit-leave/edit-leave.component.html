<div class="edit-leave-container">
  <div class="page-header">
    <h1>✏️ Edit Leave Application</h1>
    <p>Modify your pending leave request</p>
  </div>

  <!-- Loading Data State -->
  <div class="loading-container" *ngIf="loadingData">
    <div class="spinner"></div>
    <p>Loading leave data...</p>
  </div>

  <!-- Error Message -->
  <div class="alert alert-error" *ngIf="errorMessage && !loadingData && !currentLeave">
    {{ errorMessage }}
    <button class="btn btn-secondary" (click)="onCancel()" style="margin-top: 1rem;">
      Back to My Leaves
    </button>
  </div>

  <!-- Form -->
  <div class="form-card" *ngIf="!loadingData && currentLeave">
    <form [formGroup]="editLeaveForm" (ngSubmit)="onSubmit()">
      
      <!-- Leave ID Info -->
      <div class="info-box">
        <strong>Leave ID:</strong> {{ currentLeave.leaveId }} | 
        <strong>Status:</strong> <span class="status-badge status-pending">{{ currentLeave.status }}</span>
      </div>

      <!-- Leave Type -->
      <div class="form-group">
        <label for="leaveType">Leave Type <span class="required">*</span></label>
        <select id="leaveType" formControlName="leaveType" class="form-control">
          <option value="">-- Select Leave Type --</option>
          <option *ngFor="let type of leaveTypes" [value]="type">
            {{ type.replace('_', ' ') }}
          </option>
        </select>
        <div class="error-message" *ngIf="editLeaveForm.get('leaveType')?.touched && editLeaveForm.get('leaveType')?.invalid">
          Leave type is required
        </div>
      </div>

      <!-- Start Date -->
      <div class="form-group">
        <label for="startDate">Start Date <span class="required">*</span></label>
        <input type="date" id="startDate" formControlName="startDate" class="form-control">
        <div class="error-message" *ngIf="editLeaveForm.get('startDate')?.touched && editLeaveForm.get('startDate')?.invalid">
          Start date is required
        </div>
      </div>

      <!-- End Date -->
      <div class="form-group">
        <label for="endDate">End Date <span class="required">*</span></label>
        <input type="date" id="endDate" formControlName="endDate" class="form-control">
        <div class="error-message" *ngIf="editLeaveForm.get('endDate')?.touched && editLeaveForm.get('endDate')?.invalid">
          End date is required
        </div>
        <div class="error-message" *ngIf="editLeaveForm.errors?.['dateRangeInvalid'] && editLeaveForm.get('endDate')?.touched">
          End date must be greater than or equal to start date
        </div>
      </div>

      <!-- Reason -->
      <div class="form-group">
        <label for="reason">Reason <span class="required">*</span></label>
        <textarea id="reason" formControlName="reason" rows="4" class="form-control" placeholder="Enter reason for leave (minimum 10 characters)"></textarea>
        <div class="error-message" *ngIf="editLeaveForm.get('reason')?.touched && editLeaveForm.get('reason')?.invalid">
          Reason is required (minimum 10 characters)
        </div>
      </div>

      <!-- Error Message -->
      <div class="alert alert-error" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <!-- Success Message -->
      <div class="alert alert-success" *ngIf="successMessage">
        {{ successMessage }}
      </div>

      <!-- Buttons -->
      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="loading || editLeaveForm.invalid">
          <span *ngIf="!loading">Update Leave</span>
          <span *ngIf="loading">Updating...</span>
        </button>
        <button type="button" class="btn btn-secondary" (click)="onCancel()" [disabled]="loading">
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>
